<?xml version="1.0" encoding="UTF-8"?>
<svg viewBox="0 0 800 500" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="800" height="500" fill="#f9f9f9"/>
  
  <!-- Title -->
  <text x="400" y="40" font-family="Arial, sans-serif" font-size="24" font-weight="bold" text-anchor="middle">Thread Block Scheduling on SMs</text>
  
  <!-- CUDA Runtime Manager -->
  <rect x="50" y="80" width="180" height="60" rx="10" fill="#4287f5" stroke="#2b5797" stroke-width="2"/>
  <text x="140" y="115" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white" text-anchor="middle">CUDA Runtime</text>
  <text x="140" y="135" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">Block Scheduler</text>
  
  <!-- GPU with SMs -->
  <rect x="320" y="180" width="430" height="240" rx="5" fill="#e0e0e0" stroke="#666" stroke-width="2"/>
  <text x="535" y="202" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle">GPU</text>

  <!-- SM 1 -->
  <rect x="340" y="220" width="120" height="180" rx="5" fill="#ffffff" stroke="#666" stroke-width="2"/>
  <text x="400" y="240" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">SM 1</text>
  
  <!-- Blocks in SM 1 -->
  <rect x="350" y="250" width="100" height="30" rx="5" fill="#76b852" stroke="#666" stroke-width="1"/>
  <text x="400" y="270" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">Block 1</text>
  
  <rect x="350" y="290" width="100" height="30" rx="5" fill="#76b852" stroke="#666" stroke-width="1"/>
  <text x="400" y="310" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">Block 3</text>
  
  <rect x="350" y="330" width="100" height="30" rx="5" fill="#76b852" stroke="#666" stroke-width="1"/>
  <text x="400" y="350" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">Block 7</text>
  
  <!-- SM 2 -->
  <rect x="480" y="220" width="120" height="180" rx="5" fill="#ffffff" stroke="#666" stroke-width="2"/>
  <text x="540" y="240" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">SM 2</text>
  
  <!-- Blocks in SM 2 -->
  <rect x="490" y="250" width="100" height="30" rx="5" fill="#76b852" stroke="#666" stroke-width="1"/>
  <text x="540" y="270" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">Block 2</text>
  
  <rect x="490" y="290" width="100" height="30" rx="5" fill="#76b852" stroke="#666" stroke-width="1"/>
  <text x="540" y="310" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">Block 4</text>
  
  <!-- SM 3 -->
  <rect x="620" y="220" width="120" height="180" rx="5" fill="#ffffff" stroke="#666" stroke-width="2"/>
  <text x="680" y="240" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">SM 3</text>
  
  <!-- Blocks in SM 3 -->
  <rect x="630" y="250" width="100" height="30" rx="5" fill="#76b852" stroke="#666" stroke-width="1"/>
  <text x="680" y="270" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">Block 5</text>
  
  <rect x="630" y="290" width="100" height="30" rx="5" fill="#76b852" stroke="#666" stroke-width="1"/>
  <text x="680" y="310" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">Block 6</text>
  
  <!-- Waiting Queue -->
  <rect x="50" y="180" width="200" height="240" rx="5" fill="#f0f0f0" stroke="#666" stroke-width="2"/>
  <text x="150" y="200" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle">Block Queue</text>
  
  <!-- Waiting Blocks -->
  <rect x="80" y="220" width="140" height="30" rx="5" fill="#ff9900" stroke="#666" stroke-width="1"/>
  <text x="150" y="240" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Block 8</text>
  
  <rect x="80" y="260" width="140" height="30" rx="5" fill="#ff9900" stroke="#666" stroke-width="1"/>
  <text x="150" y="280" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Block 9</text>
  
  <rect x="80" y="300" width="140" height="30" rx="5" fill="#ff9900" stroke="#666" stroke-width="1"/>
  <text x="150" y="320" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Block 10</text>
  
  <rect x="80" y="340" width="140" height="30" rx="5" fill="#ff9900" stroke="#666" stroke-width="1"/>
  <text x="150" y="360" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Block 11</text>
  
  <rect x="80" y="380" width="140" height="30" rx="5" fill="#ff9900" stroke="#666" stroke-width="1" stroke-dasharray="5,3"/>
  <text x="150" y="400" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">...</text>
  
  <!-- Arrows -->
  <path d="M 140 140 L 140 170" stroke="#333" stroke-width="2" stroke-linecap="round" fill="none"/>
  <path d="M 137 165 L 140 175 L 143 165" stroke="#333" stroke-width="2" stroke-linecap="round" fill="none"/>
  
  <!-- Arrow from queue to SMs -->
  <path d="M 250 250 L 320 250" stroke="#333" stroke-width="2" stroke-linecap="round" fill="none"/>
  <path d="M 315 247 L 325 250 L 315 253" stroke="#333" stroke-width="2" stroke-linecap="round" fill="none"/>
  
  <path d="M 250 290 L 320 290" stroke="#333" stroke-width="2" stroke-linecap="round" fill="none"/>
  <path d="M 315 287 L 325 290 L 315 293" stroke="#333" stroke-width="2" stroke-linecap="round" fill="none"/>
  
  <path d="M 250 330 L 320 330" stroke="#333" stroke-width="2" stroke-linecap="round" fill="none" stroke-dasharray="5,3"/>
  <path d="M 315 327 L 325 330 L 315 333" stroke="#333" stroke-width="2" stroke-linecap="round" fill="none"/>
  
  <!-- Limitations Legend -->
  <rect x="50" y="430" width="700" height="60" rx="5" fill="#f5f5dc" stroke="#666" stroke-width="1"/>
  <text x="400" y="450" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">SM Resource Limitations</text>
  
  <text x="100" y="472" font-family="Arial, sans-serif" font-size="12" text-anchor="start">• Thread Count</text>
  <text x="220" y="472" font-family="Arial, sans-serif" font-size="12" text-anchor="start">• Shared Memory</text>
  <text x="380" y="472" font-family="Arial, sans-serif" font-size="12" text-anchor="start">• Register Pressure</text>
  <text x="550" y="472" font-family="Arial, sans-serif" font-size="12" text-anchor="start">• Max Blocks per SM</text>
</svg>