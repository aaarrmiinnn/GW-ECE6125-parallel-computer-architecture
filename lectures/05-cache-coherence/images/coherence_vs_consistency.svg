<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg width="1200" height="900" xmlns="http://www.w3.org/2000/svg">
  <!-- Coherence vs Consistency Diagram with improved layout -->
  
  <!-- Background -->
  <rect x="0" y="0" width="1200" height="900" fill="#f9f9f9"/>
  
  <!-- Title with background -->
  <rect x="250" y="40" width="700" height="60" rx="15" ry="15" fill="#f0f8ff" stroke="#0066cc" stroke-width="3"/>
  <text x="600" y="80" font-family="Arial" font-size="32" text-anchor="middle" font-weight="bold">Cache Coherence vs Memory Consistency</text>
  
  <!-- Two columns layout with improved spacing -->
  <rect x="100" y="150" width="450" height="600" rx="15" ry="15" fill="#e6f7ff" stroke="#0066cc" stroke-width="3"/>
  <rect x="650" y="150" width="450" height="600" rx="15" ry="15" fill="#fff2e6" stroke="#ff6600" stroke-width="3"/>
  
  <!-- Column headers -->
  <rect x="150" y="180" width="350" height="40" rx="5" ry="5" fill="#0066cc" stroke="none"/>
  <text x="325" y="210" font-family="Arial" font-size="28" text-anchor="middle" font-weight="bold" fill="white">Cache Coherence</text>
  
  <rect x="700" y="180" width="350" height="40" rx="5" ry="5" fill="#ff6600" stroke="none"/>
  <text x="875" y="210" font-family="Arial" font-size="28" text-anchor="middle" font-weight="bold" fill="white">Memory Consistency</text>
  
  <!-- Column descriptions -->
  <rect x="175" y="235" width="300" height="30" rx="5" ry="5" fill="#fff" stroke="#0066cc" stroke-width="1"/>
  <text x="325" y="255" font-family="Arial" font-size="18" text-anchor="middle" font-style="italic">"What" data is visible</text>
  
  <rect x="725" y="235" width="300" height="30" rx="5" ry="5" fill="#fff" stroke="#ff6600" stroke-width="1"/>
  <text x="875" y="255" font-family="Arial" font-size="18" text-anchor="middle" font-style="italic">"When" data is visible</text>
  
  <!-- Coherence content with better spacing -->
  <text x="150" y="300" font-family="Arial" font-size="22" font-weight="bold" fill="#0066cc">Definition:</text>
  <rect x="150" y="310" width="350" height="60" rx="5" ry="5" fill="#fff" stroke="#0066cc" stroke-width="1"/>
  <text x="165" y="335" font-family="Arial" font-size="18">Ensures all processors see a</text>
  <text x="165" y="360" font-family="Arial" font-size="18">consistent view of memory</text>
  
  <text x="150" y="400" font-family="Arial" font-size="22" font-weight="bold" fill="#0066cc">Concerns:</text>
  <rect x="150" y="410" width="350" height="120" rx="5" ry="5" fill="#fff" stroke="#0066cc" stroke-width="1"/>
  <text x="165" y="435" font-family="Arial" font-size="18">• Visibility of writes</text>
  <text x="165" y="465" font-family="Arial" font-size="18">• Propagation of updates</text>
  <text x="165" y="495" font-family="Arial" font-size="18">• Maintaining data integrity</text>
  
  <text x="150" y="560" font-family="Arial" font-size="22" font-weight="bold" fill="#0066cc">Implementation:</text>
  <rect x="150" y="570" width="350" height="120" rx="5" ry="5" fill="#fff" stroke="#0066cc" stroke-width="1"/>
  <text x="165" y="595" font-family="Arial" font-size="18">• MSI, MESI, MOESI protocols</text>
  <text x="165" y="625" font-family="Arial" font-size="18">• Snooping or Directory-based</text>
  <text x="165" y="655" font-family="Arial" font-size="18">• Cache-line granularity</text>
  
  <!-- Consistency content with better spacing -->
  <text x="700" y="300" font-family="Arial" font-size="22" font-weight="bold" fill="#ff6600">Definition:</text>
  <rect x="700" y="310" width="350" height="60" rx="5" ry="5" fill="#fff" stroke="#ff6600" stroke-width="1"/>
  <text x="715" y="335" font-family="Arial" font-size="18">Defines ordering constraints on</text>
  <text x="715" y="360" font-family="Arial" font-size="18">memory operations</text>
  
  <text x="700" y="400" font-family="Arial" font-size="22" font-weight="bold" fill="#ff6600">Concerns:</text>
  <rect x="700" y="410" width="350" height="120" rx="5" ry="5" fill="#fff" stroke="#ff6600" stroke-width="1"/>
  <text x="715" y="435" font-family="Arial" font-size="18">• Operation ordering</text>
  <text x="715" y="465" font-family="Arial" font-size="18">• Reordering constraints</text>
  <text x="715" y="495" font-family="Arial" font-size="18">• Memory barrier semantics</text>
  
  <text x="700" y="560" font-family="Arial" font-size="22" font-weight="bold" fill="#ff6600">Models:</text>
  <rect x="700" y="570" width="350" height="120" rx="5" ry="5" fill="#fff" stroke="#ff6600" stroke-width="1"/>
  <text x="715" y="595" font-family="Arial" font-size="18">• Sequential Consistency</text>
  <text x="715" y="625" font-family="Arial" font-size="18">• Total Store Order (x86)</text>
  <text x="715" y="655" font-family="Arial" font-size="18">• Release Consistency (ARM)</text>
  
  <!-- Examples with clear separation -->
  <rect x="175" y="275" width="300" height="85" rx="10" ry="10" fill="#ffffff" stroke="#0066cc" stroke-width="2" opacity="0.9"/>
  <text x="325" y="300" font-family="Courier" font-size="16" text-anchor="middle" font-weight="bold">Example:</text>
  <text x="325" y="325" font-family="Courier" font-size="16" text-anchor="middle">P1: X = NEW</text>
  <text x="325" y="350" font-family="Courier" font-size="16" text-anchor="middle">P2 reads X</text>
  
  <rect x="725" y="275" width="300" height="85" rx="10" ry="10" fill="#ffffff" stroke="#ff6600" stroke-width="2" opacity="0.9"/>
  <text x="875" y="300" font-family="Courier" font-size="16" text-anchor="middle" font-weight="bold">Example:</text>
  <text x="875" y="325" font-family="Courier" font-size="16" text-anchor="middle">P1: X = 1; Y = 2;</text>
  <text x="875" y="350" font-family="Courier" font-size="16" text-anchor="middle">P2: if(Y==2) use(X)</text>
  
  <!-- Key differences -->
  <rect x="175" y="500" width="300" height="50" rx="10" ry="10" fill="#ffffff" stroke="#0066cc" stroke-width="2" opacity="0.9"/>
  <text x="325" y="530" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold">Must see most recent value</text>
  
  <rect x="725" y="500" width="300" height="50" rx="10" ry="10" fill="#ffffff" stroke="#ff6600" stroke-width="2" opacity="0.9"/>
  <text x="875" y="530" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold">Must see values in correct order</text>
  
  <!-- Visual connector between the concepts -->
  <path d="M550 450 L650 450" stroke="#333" stroke-width="3" stroke-dasharray="10,5"/>
  <rect x="550" y="400" width="100" height="100" rx="50" ry="50" fill="#f0f8ff" stroke="#333" stroke-width="2"/>
  <text x="600" y="440" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold">Both</text>
  <text x="600" y="460" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold">Required</text>
  
  <!-- Illustration of the relationship -->
  <rect x="250" y="800" width="700" height="60" rx="15" ry="15" fill="#f0f8ff" stroke="#333" stroke-width="2"/>
  <text x="600" y="840" font-family="Arial" font-size="24" text-anchor="middle" font-weight="bold">Both are required for correct parallel execution</text>
</svg> 